"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[188],{4188:function(e,n,s){s.r(n),s.d(n,{default:function(){return p},meta:function(){return u}});var t=s(1527),a=s(313),i=s(7345),c=s(2903),l=s(959),r=s(58),o=s.n(r);let h=l.memo(e=>{let{css:n,id:s}=e,a=(0,l.useRef)(null),r=(0,l.useRef)(!1);(0,l.useEffect)(()=>{r.current||((0,i.sY)({root:a.current}),r.current=!0)},[]);let o=(0,l.useMemo)(()=>c.Z.highlight(n,{language:"css"}).value.trim(),[n]);return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"bg-[#222] p-1",children:[(0,t.jsx)("div",{className:"px-3 py-1 bg-[#111] font-bold text-xs",children:"Result"}),(0,t.jsx)("div",{className:"px-3 py-2",children:(0,t.jsx)("div",{ref:a,id:s})})]}),(0,t.jsx)("pre",{children:(0,t.jsx)("code",{className:"hljs language-css",dangerouslySetInnerHTML:{__html:o}})}),(0,t.jsx)("style",{children:n})]})});h.displayName="CssEverything";var d=o()(async()=>h,{ssr:!1});let u={title:"Let's build everything in CSS",description:"Using css-everything to build interactive websites with turing complete CSS",published:!1,date:"2024-06-01"};function m(e){let n=Object.assign({blockquote:"blockquote",p:"p",hr:"hr",a:"a",h2:"h2",ul:"ul",li:"li",code:"code",h3:"h3",pre:"pre",span:"span",h4:"h4"},(0,a.ah)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"The following events are based on a true story that I made up in my head."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:'It all started when I was a child and a shady looking stranger wearing a hooded jacket walked up to me and started a conversation.\nWe were talking about the weather and how hot it was and then he said "speaking of hot, you know what the hottest thing is right now? CSS!".'}),"\n",(0,t.jsx)(n.p,{children:'Completely disoriented by the segue, the only sentence my brain was able to muster was "what?".'}),"\n",(0,t.jsx)(n.p,{children:"He said \"Oh yeah. You heard of CSS? It's this incredible new thing on the streets. All the cool kids are doing it. Creating really fancy websites with seizure inducing color flashes\". Being the year 2014, the statement itself wasn't wrong. Tailwind didn't exist and bootstrap was only used by backend asshats who didn't care what their websites looked like."}),"\n",(0,t.jsx)(n.p,{children:'Intrigued, I asked "what is it like?".'}),"\n",(0,t.jsx)(n.p,{children:'With a smile on his face he couldn\'t control, he replied "Oh it is incredible! Everything is full of colors! You can make things move without the marquee element!". I was sold. "No marquee?! That\'s amazing.", I exclaimed. "Yes! Here, take this", he said handing me a piece of paper with some css written on it. "First one\'s for free".'}),"\n",(0,t.jsx)(n.p,{children:"I looked at the snippet of CSS and that's when it hit me. This was the future! At that moment, I was sure that by the year 2020, flying cars will be running on CSS."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.p,{children:"Unfortunately, that hasn't happened yet and instead we got a microscopic being that shut down the world. I believe the reason we never got flying cars and also why the pandemic happened is that they didn't make CSS a turing complete programming language."}),"\n",(0,t.jsxs)(n.p,{children:["So to fix that, I created ",(0,t.jsx)(n.a,{href:"https://github.com/phenax/css-everything",children:"css-everything"}),". It's a library that allows you to write turing-complete CSS to build fully interactive websites if you're brave enough."]}),"\n",(0,t.jsx)(n.h2,{children:"What can it do?"}),"\n",(0,t.jsx)(n.p,{children:"Here's an example of a counter in css-everything"}),"\n",(0,t.jsx)(d,{id:"counter",css:"\n#counter {\n  --counter: '0';\n  --cssx-children: button#decr div#count button#incr;\n\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n\n#count {\n  min-width: 100px;\n  text-align: center;\n}\n#count::after {\n  content: \"Count: \" var(--counter);\n}\n\n#counter button {\n  padding: 0.5rem 1rem;\n  color: #b29b3e;\n}\n#incr {\n  --cssx-on-click: update('#counter', --counter, calc(get-var(--counter) + 1));\n  --cssx-text: \"increment\";\n}\n#decr {\n  --cssx-on-click: update('#counter', --counter, calc(get-var(--counter) - 1));\n  --cssx-text: \"decrement\";\n}\n"},"counter"),"\n",(0,t.jsx)(n.p,{children:'You might be thinking to yourself "That is the dumbest thing I\'ve seen all day and I want more. What else can I do with it?". The answer is anything and everything.'}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Wanna do some math, just use ",(0,t.jsx)(n.code,{children:"calc"})]}),"\n",(0,t.jsxs)(n.li,{children:["Want to manage state, just use css variables and ",(0,t.jsx)(n.code,{children:"update"})," function"]}),"\n",(0,t.jsxs)(n.li,{children:["Want to create dom-elements, ",(0,t.jsx)(n.code,{children:"--cssx-children"})," will do that for you"]}),"\n",(0,t.jsxs)(n.li,{children:["Want to call custom functions, just use ",(0,t.jsx)(n.code,{children:"call"})]}),"\n",(0,t.jsxs)(n.li,{children:["Wanna make an api call, just call ",(0,t.jsx)(n.code,{children:"request"})]}),"\n",(0,t.jsx)(n.li,{children:"..."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Wanna build a factorial calculator with it? Here you go:"}),"\n",(0,t.jsx)(d,{id:"factorial",css:"\n#factorial {\n  --cssx-children: #factorial-container;\n\n  /* There are no types here. func is a noop function for documentation. So exactly like typescript */\n  --factorial: func(--n: number)\n    if(lte(get-var(--n), 1),\n      1,\n      calc(\n        get-var(--n)\n        * call(--factorial, map(--n: calc(get-var(--n) - 1)))\n      ));\n}\n\n#factorial-container {\n  --cssx-children: form#factorial-form #factorial-output;\n\n  --number: '';\n  --cssx-on-mount: update(--number, '5');\n  --cssx-on-update:\n    update(factorial-output, --result, call(--factorial, map(--n: get-var(--number))));\n}\n\n#factorial-form {\n  --cssx-children:\n    input#factorial-input[name=\"number\"][type=\"number\"][placeholder=\"Enter a number\"]\n    button#factorial-submit[type=\"submit\"];\n\n  --cssx-on-submit:\n    prevent-default()\n    update(factorial-container, --number, attr(factorial-input, value));\n}\n#factorial-input {\n  --cssx-on-mount: set-attr(value, get-var(--number));\n}\n#factorial-submit {\n  --cssx-text: Calculate;\n  color: #b29b3e;\n  padding: 0 1rem;\n}\n\n#factorial-output { --result: ''; }\n#factorial-output::after {\n  content: var(--number) '! = ' var(--result);\n}\n"},"factorial"),"\n",(0,t.jsx)(n.p,{children:'Looking at that you might think, "oh that must be running js to calculate the factorial behind the\nscenes". Nope. I mean yeah, it does run js but the way custom function work is very different from\nhow js does it. More on that later but spoiler alert, it uses dom nodes.'}),"\n",(0,t.jsx)(n.h2,{children:"Wanna build components?"}),"\n",(0,t.jsxs)(n.p,{children:['"I want to build components" said the react developer. So here you go, we call them ',(0,t.jsx)(n.code,{children:"instances"}),"."]}),"\n",(0,t.jsx)(d,{id:"cookie-clicker",css:'\n#cookie-clicker {\n  --cssx-children:\n    instance(#cookies-component, map(--count: 5))\n    instance(#cookies-component, map(--count: 8))\n    instance(#cookies-component, map(--count: 13))\n    instance(#cookies-component, map(--count: 21))\n    instance(#cookies-component, map(--count: 34));\n}\n#cookie-clicker > div {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n\n/* data-instance attribute selector is used instead of ids because ids have to\nbe unique for instances. We can access this id using attr(data-element) */\n[data-instance=cookies-component] {\n  --count: \'0\';\n  --cssx-children: button#counter-increment;\n  --cssx-on-mount: update(--component-id, attr(data-element));\n\n  min-width: 120px;\n  padding: .5rem .5rem 0;\n  text-align: center;\n  border: 1px solid #b29b3e;\n}\n[data-instance=cookies-component]::before {\n  content: "Cookies: " var(--count);\n}\n\n[data-instance=cookies-component] #counter-increment {\n  --cssx-on-click: update(get-var(--component-id), --count, calc(get-var(--count) + 1));\n  --cssx-text: "click";\n\n  padding: 0.5rem;\n  color: #b29b3e;\n}\n'},"cookies-component"),"\n",(0,t.jsx)(n.h2,{children:"Escape hatches?"}),"\n",(0,t.jsx)(n.h3,{children:"Run javascript from CSS"}),"\n",(0,t.jsxs)(n.p,{children:["JS-in-CSS is the feature that's going to change the world. You can call ",(0,t.jsx)(n.code,{children:"js-eval"})," from any css-everything expression to run javascript code."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{className:"hljs language-css",children:[(0,t.jsx)(n.span,{className:"hljs-selector-id",children:"#js-in-css"})," { ",(0,t.jsx)(n.span,{className:"hljs-attr",children:"--cssx-on-mount"}),": ",(0,t.jsx)(n.span,{className:"hljs-built_in",children:"js-eval"}),"(",(0,t.jsx)(n.span,{className:"hljs-string",children:"\"console.log('Hello from css!')\""}),"); }\n"]})}),"\n",(0,t.jsx)(d,{id:"clock",css:"\n#clock { --cssx-children: #digital; }\n#digital {\n  --text: \"\";\n\n  --my-js-expression:\n    new Intl.DateTimeFormat('en-US', {\n      hour: 'numeric',\n      minute: 'numeric',\n      second: 'numeric',\n    }).format(new Date());\n  --get-date: js-eval(get-var(--my-js-expression));\n\n  --cssx-on-mount: update(--text, call(--get-date));\n  --cssx-on-update: delay(1s) update(--text, call(--get-date));\n\n  font-size: 1.5rem;\n  font-family: monospace;\n}\n#digital::after { content: var(--text); }\n"},"clock"),"\n",(0,t.jsx)(n.h3,{children:"Render html"}),"\n",(0,t.jsxs)(n.p,{children:["What? Eww. Why would you want to do that? Alright if you really want to, you can use ",(0,t.jsx)(n.code,{children:"--cssx-disgustingly-set-innerhtml"})," to set innerHTML of an element."]}),"\n",(0,t.jsx)(d,{id:"html",css:"\n#html {\n  --cssx-disgustingly-set-innerhtml: \"<div>Some <b>disgusting</b> <span style='color:red;'>html</span></div>\";\n}\n"},"html"),"\n",(0,t.jsx)(n.h2,{children:"How does it work?"}),"\n",(0,t.jsx)(n.h4,{children:"CSS variables"}),"\n",(0,t.jsx)(n.p,{children:"CSS variables are the backbone of css-everything. They maintain the state, listen to events, create\ndom trees and in general is the glue between js and css."}),"\n",(0,t.jsx)(n.h4,{children:"calc"}),"\n",(0,t.jsxs)(n.p,{children:["You might already know ",(0,t.jsx)(n.code,{children:"calc"})," but the calc you use inside css-everything expressions are a little\ndifferent. They are evaluated in javascript\nand have limited support for css things."]}),"\n",(0,t.jsx)(n.h4,{children:"Custom functions"}),"\n",(0,t.jsxs)(n.p,{children:["The way custom function calls work in ",(0,t.jsx)(n.code,{children:"css-everything"})," is each call is represented as a dom node\ninside the caller. The arguments passed to the function call are css variables on this new dom node\nwhich represents our closure. The function is then executed within the context of our closure. In a\nrecursive function like the one above, each function call results in a dom node inside the previous\ndom node resulting is a tree like this:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{className:"hljs language-html",children:[(0,t.jsxs)(n.span,{className:"hljs-tag",children:["<",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"})," ",(0,t.jsx)(n.span,{className:"hljs-attr",children:"id"}),"=",(0,t.jsx)(n.span,{className:"hljs-string",children:'"factorial-state"'}),">"]}),"\n  ",(0,t.jsxs)(n.span,{className:"hljs-tag",children:["<",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"})," ",(0,t.jsx)(n.span,{className:"hljs-attr",children:"class"}),"=",(0,t.jsx)(n.span,{className:"hljs-string",children:'"cssx-layer"'}),">"]}),(0,t.jsxs)(n.span,{className:"hljs-tag",children:["</",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"}),">"]})," ",(0,t.jsx)(n.span,{className:"hljs-comment",children:"<!-- This is where the children would go... if you had any, you virgin -->"}),"\n\n  ",(0,t.jsxs)(n.span,{className:"hljs-tag",children:["<",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"})," ",(0,t.jsx)(n.span,{className:"hljs-attr",children:"style"}),"=",(0,t.jsx)(n.span,{className:"hljs-string",children:'"display: none; --n: 5;"'}),">"]}),"\n    ",(0,t.jsxs)(n.span,{className:"hljs-tag",children:["<",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"})," ",(0,t.jsx)(n.span,{className:"hljs-attr",children:"style"}),"=",(0,t.jsx)(n.span,{className:"hljs-string",children:'"display: none; --n: 4;"'}),">"]}),"\n      ",(0,t.jsxs)(n.span,{className:"hljs-tag",children:["<",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"})," ",(0,t.jsx)(n.span,{className:"hljs-attr",children:"style"}),"=",(0,t.jsx)(n.span,{className:"hljs-string",children:'"display: none; --n: 3;"'}),">"]}),"\n        ",(0,t.jsxs)(n.span,{className:"hljs-tag",children:["<",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"})," ",(0,t.jsx)(n.span,{className:"hljs-attr",children:"style"}),"=",(0,t.jsx)(n.span,{className:"hljs-string",children:'"display: none; --n: 2;"'}),">"]}),"\n          ",(0,t.jsxs)(n.span,{className:"hljs-tag",children:["<",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"})," ",(0,t.jsx)(n.span,{className:"hljs-attr",children:"style"}),"=",(0,t.jsx)(n.span,{className:"hljs-string",children:'"display: none; --n: 1;"'}),">"]}),(0,t.jsxs)(n.span,{className:"hljs-tag",children:["</",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"}),">"]}),"\n        ",(0,t.jsxs)(n.span,{className:"hljs-tag",children:["</",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"}),">"]}),"\n      ",(0,t.jsxs)(n.span,{className:"hljs-tag",children:["</",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"}),">"]}),"\n    ",(0,t.jsxs)(n.span,{className:"hljs-tag",children:["</",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"}),">"]}),"\n  ",(0,t.jsxs)(n.span,{className:"hljs-tag",children:["</",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"}),">"]}),"\n",(0,t.jsxs)(n.span,{className:"hljs-tag",children:["</",(0,t.jsx)(n.span,{className:"hljs-name",children:"div"}),">"]}),"\n"]})}),"\n",(0,t.jsx)(n.p,{children:"This is our call stack. When the call finally has a result, it collapses the stack and returns with the value."}),"\n",(0,t.jsx)(n.p,{children:'You might be thinking, "But what about the performance?". If so, its pretty cool that you thought that. Good job.'}),"\n",(0,t.jsx)(n.h2,{children:"Performance"}),"\n",(0,t.jsx)(n.p,{children:"Fuck you."}),"\n",(0,t.jsx)(n.h2,{children:"Conclusion"}),"\n",(0,t.jsx)(n.p,{children:"This is the future of web development. Suck it! Flying cars, here we come!"}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.p,{children:"On a serious note tho, if you're considering using this, please consult a psychiatrist.\nI made this because one day while working, I started picturing one of the circles of hell being\nhaving to write and debug css issues for an eternity."})]})}var p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?(0,t.jsx)(n,Object.assign({},e,{children:(0,t.jsx)(m,e)})):m(e)}}}]);